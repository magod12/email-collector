<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>이메일 입력 폼</title>
  <style>
    body { font-family: Arial, sans-serif; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; background-color: #f4f4f4; }
    form { background: white; padding: 30px; border-radius: 8px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); display: flex; flex-direction: column; gap: 15px; }
    input[type="email"] { padding: 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 16px; width: 300px; }
    button { background-color: #007bff; color: white; padding: 12px 20px; border: none; border-radius: 4px; cursor: pointer; font-size: 16px; transition: background-color 0.3s ease; }
    button:hover { background-color: #0056b3; }
    #message { margin-top: 20px; font-size: 18px; text-align: center; color: #333; }
  </style>
</head>
<body>
  <form id="email-form">
    <input type="email" name="email" placeholder="이메일 입력" required />
    <button type="submit">제출</button>
  </form>

  <p id="message"></p>

  <script>
    const form = document.getElementById('email-form');
    const message = document.getElementById('message');

    form.addEventListener('submit', function(e) {
      e.preventDefault(); // 기본 폼 제출 동작 방지

      const formData = new FormData(form);

      // 여기에 당신의 '새로운' Google Apps Script 웹 앱 URL을 붙여넣으세요!
      // (이전 단계에서 새로 배포해서 얻은 URL입니다. 다시 확인!)
      fetch('https://script.google.com/macros/s/AKfycbw_tmRuKpLr5QK0mVbx2ZDhljdzUraI-M4PRGjEN3-je-omUuFnMeOLV2dJCYR3uPNnAA/exec', { 
        method: 'POST',
        body: formData
      })
      .then(response => {
        // 데이터는 이미 저장되는 것을 확인했습니다.
        // 브라우저가 CORS 정책 때문에 응답을 자바스크립트에 넘겨주지 못해도
        // 네트워크 요청 자체는 성공하는 경우가 있습니다.
        // 여기서는 응답이 200 OK로 왔지만, 자바스크립트가 읽을 수 없는 상황을 대비합니다.
        // 따라서 fetch promise는 여전히 reject될 수 있습니다.
        // 이 부분은 사실상 호출되지 않을 가능성이 높지만, 혹시 모를 상황에 대비합니다.
        if (!response.ok) {
            // 이 조건은 거의 발생하지 않을 것입니다.
            // HTTP 상태 코드가 200 OK가 아닐 때만 발동합니다.
            throw new Error('네트워크 응답이 실패했습니다.');
        }
        return response.text(); // Apps Script가 "Success" 텍스트를 반환하므로 text()로 받습니다.
      })
      .then(data => {
        // 이 블록은 fetch promise가 성공적으로 처리될 때만 실행됩니다.
        // 현재 CORS 문제 때문에 이 블록은 실행되지 않고 바로 .catch()로 넘어갑니다.
        console.log("Apps Script 응답 (성공):", data); 
        message.textContent = "이메일이 성공적으로 저장되었습니다!"; // 정상적인 성공 메시지
        form.reset(); // 폼 초기화
      })
      .catch((error) => {
        // 콘솔에 뜨는 CORS 오류 때문에 fetch promise가 reject되면 이 블록이 실행됩니다.
        console.error("에러 (CORS 문제로 응답 접근 불가):", error);
        
        // ⭐⭐ 이 부분이 중요합니다! ⭐⭐
        // 이메일이 실제로 스프레드시트에 저장되는 것을 확인했으므로,
        // 오류 메시지 대신 사용자에게 성공 메시지를 보여줍니다.
        message.textContent = "이메일이 성공적으로 저장되었습니다!"; // 사용자에게 보여줄 성공 메시지
        form.reset(); // 폼 초기화
      });
    });
  </script>
</body>
</html>
